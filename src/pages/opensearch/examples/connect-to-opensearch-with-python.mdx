---
title: Connecting to an OpenSearch Cluster with Python
metaTitle: Learn How to connect to an OpenSearch Cluster with Python
pagination: false
timestamp: false
stackTypes: opensearch
---

## Connect to an OpenSearch Cluster with Python

This article assumes that you have already created an OpenSearch Cluster, if you have not yet done this then 
please see this guide to create to create a cluster:

[Creating an OpenSearch Cluster](creating-opensearch-cluster.mdx)

Here's a Python example of sending logs to OpenSearch, this example uses __opensearch-py__ client and 
the __logging library__ for integration.

<Steps>
  ### Install Dependencies

  * Install the __opensearch-py__ package for interacting with OpenSearch.

  ```bash copy
  pip install opensearch-py
  ```

  ### Python Code Example

  ```python copy filename="program.py" /@elasticsearch.endpointAddress/ /@elasticsearch.username/ /@elasticsearch.password/
    import logging
    from opensearchpy import OpenSearch
    from logging.handlers import HTTPHandler

    # OpenSearch configuration
    opensearch_endpoint = "@elasticsearch.endpointAddress"
    username = "@elasticsearch.username"
    password = "@elasticsearch.password"
    index_name = "logit-example"

    # Set up OpenSearch client with basic authentication
    client = OpenSearch(
        hosts=[opensearch_endpoint],
        http_auth=(username, password),
        use_ssl=True,
        verify_certs=True
    )

    # Function to send logs to OpenSearch
    class OpenSearchHandler(logging.Handler):
        def __init__(self, client, index):
            super().__init__()
            self.client = client
            self.index = index

        def emit(self, record):
            log_entry = self.format(record)
            try:
                self.client.index(index=self.index, body={"message": log_entry})
            except Exception as e:
                print(f"Failed to send log to OpenSearch: {e}")

    # Configure the logger
    logger = logging.getLogger("OpenSearchLogger")
    logger.setLevel(logging.INFO)

    # Create and add OpenSearch handler
    os_handler = OpenSearchHandler(client, index_name)
    formatter = logging.Formatter("%(asctime)s - %(levelname)s - %(message)s")
    os_handler.setFormatter(formatter)
    logger.addHandler(os_handler)

    # Log messages
    try:
        logger.info("This is an info log message.")
        logger.warning("This is a warning log message.")
        logger.error("This is an error log message.")
    except Exception as e:
        print(f"Logging failed: {e}")
  ```
  
  ### Key Points

  OpenSearch Client: The opensearch-py client handles the connection, authentication, and indexing.

  The IndexFormat is customizable. Adjust it based on your indexing strategy.

  Logging: The custom OpenSearchHandler sends logs to OpenSearch using the clientâ€™s index method.
  

  ### Running the Application:

  Run the script, and logs should appear in the specified index in OpenSearch.

  ### Further Help and Guidance

  See the articles below for further help and guidance as a next step:

</Steps>
